var task = require ('dataflo.ws/task/base'),
    opxi2 = require( 'opxi2node'),
    util = require( 'util' );


var redis = module.exports = function( config ) {
    this.init( config );
};

util.inherits( redis, task );

util.extend( redis.prototype, {

    run: function () {
        this.failed( "Not Implemented!" );
//        publish();
    },

    /**
     * Publishes a message in redis
     * @channel the channel to publish to
     * @message String message to be published
     *
     * return publish command response
     */
    publish: function() {
        var brokerConnection = opxi2.brokerClient();
        var resp = brokerConnection.publish( this.channel, this.message );
        brokerConnection.end();
        this.completed( resp );
    }

});



